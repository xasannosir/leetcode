-- Write your PostgreSQL query statement below
SELECT f.patient_id AS patient_id, p.patient_name AS patient_name, p.age AS age, (f.first_neg_date - f.first_pos_date) AS recovery_time FROM (SELECT pos.patient_id AS patient_id, pos.first_pos_date AS first_pos_date, MIN(neg.test_date) AS first_neg_date FROM covid_tests AS neg INNER JOIN (SELECT patient_id, MIN(test_date) AS first_pos_date FROM covid_tests WHERE result = 'Positive' GROUP BY patient_id) AS pos ON pos.patient_id = neg.patient_id WHERE neg.result = 'Negative' AND neg.test_date > pos.first_pos_date GROUP BY pos.patient_id, pos.first_pos_date) AS f INNER JOIN patients AS p ON p.patient_id = f.patient_id ORDER BY recovery_time, patient_name;

-- Write your MySQL query statement below
SELECT f.patient_id AS patient_id, p.patient_name AS patient_name, p.age AS age, DATEDIFF(f.first_neg_date, f.first_pos_date) AS recovery_time FROM (SELECT pos.patient_id AS patient_id, pos.first_pos_date AS first_pos_date, MIN(neg.test_date) AS first_neg_date FROM covid_tests AS neg INNER JOIN (SELECT patient_id, MIN(test_date) AS first_pos_date FROM covid_tests WHERE result = 'Positive' GROUP BY patient_id) AS pos ON pos.patient_id = neg.patient_id WHERE neg.result = 'Negative' AND neg.test_date > pos.first_pos_date GROUP BY pos.patient_id, pos.first_pos_date) AS f INNER JOIN patients AS p ON p.patient_id = f.patient_id ORDER BY recovery_time, patient_name;